# ğŸš€ Schoolverse é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰

## ğŸ“‹ ç›®æ¬¡

1. [ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆï¼ˆæ¨å¥¨ï¼‰](#ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆæ¨å¥¨)
2. [æ‰‹å‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](#æ‰‹å‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—)
3. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
4. [ä¾¿åˆ©ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆ](#ä¾¿åˆ©ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆ)

---

## âš¡ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆï¼ˆæ¨å¥¨ï¼‰

**ä¸€æ‹¬ã§ç’°å¢ƒã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¾ã™ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆï¼‰**

```bash
# ã‚¹ãƒ†ãƒƒãƒ—1: ã‚ªãƒ¼ãƒ«ã‚¤ãƒ³ãƒ¯ãƒ³ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
npx tsx scripts/setup-dev-env.ts

# ã‚¹ãƒ†ãƒƒãƒ—2: ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# ã‚¹ãƒ†ãƒƒãƒ—3: ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ­ã‚°ã‚¤ãƒ³å¾Œã€ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç¢ºèª
npx tsx scripts/check-current-user.ts

# ã‚¹ãƒ†ãƒƒãƒ—4: å¿…è¦ãªã‚‰ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒ«ãƒ¼ãƒ ã«è¿½åŠ 
npx tsx scripts/add-user-to-room.ts <ã‚ãªãŸã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ID> classroom
```

---

## ğŸ”§ æ‰‹å‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### ã‚¹ãƒ†ãƒƒãƒ—1: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒªã‚»ãƒƒãƒˆï¼ˆæ—¢å­˜ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ï¼‰

```bash
npx tsx scripts/reset-db.ts
```

âš ï¸ **è­¦å‘Š**: ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒå‰Šé™¤ã•ã‚Œã¾ã™ï¼

### ã‚¹ãƒ†ãƒƒãƒ—2: ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆ

```bash
npx prisma db seed
```

**ä½œæˆã•ã‚Œã‚‹ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿:**
- âœ… ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼2åï¼ˆtest-user-1, test-user-2ï¼‰
- âœ… ãƒ«ãƒ¼ãƒ 3ã¤ï¼ˆclassroom, gallery, parkï¼‰
- âœ… ãƒ«ãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—

### ã‚¹ãƒ†ãƒƒãƒ—3: ã‚µãƒ¼ãƒãƒ¼èµ·å‹•

```bash
npm run dev
```

### ã‚¹ãƒ†ãƒƒãƒ—4: ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ç¢ºèª

```bash
npx tsx scripts/check-current-user.ts
```

### ã‚¹ãƒ†ãƒƒãƒ—5: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒ«ãƒ¼ãƒ ã«è¿½åŠ ï¼ˆå¿…è¦ãªå ´åˆï¼‰

```bash
# ä½¿ã„æ–¹: npx tsx scripts/add-user-to-room.ts <ãƒ¦ãƒ¼ã‚¶ãƒ¼ID> <ãƒ«ãƒ¼ãƒ ID>

# ä¾‹: classroomã«è¿½åŠ 
npx tsx scripts/add-user-to-room.ts user-abc123 classroom

# ä¾‹: ã™ã¹ã¦ã®ãƒ«ãƒ¼ãƒ ã«è¿½åŠ 
npx tsx scripts/add-user-to-room.ts user-abc123 classroom
npx tsx scripts/add-user-to-room.ts user-abc123 gallery
npx tsx scripts/add-user-to-room.ts user-abc123 park
```

---

## ğŸ› ï¸ ä¾¿åˆ©ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆ

### ğŸ“‹ ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§è¡¨ç¤º

```bash
npx tsx scripts/list-users.ts
```

**å‡ºåŠ›ä¾‹:**
```
ğŸ‘¥ Listing all users...

Found 3 user(s):

1. ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼1
   ID: test-user-1
   Email: test1@example.com
   Room memberships: 3

2. ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼2
   ID: test-user-2
   Email: test2@example.com
   Room memberships: 2
```

### ğŸ” ç¾åœ¨ãƒ­ã‚°ã‚¤ãƒ³ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ç¢ºèª

```bash
npx tsx scripts/check-current-user.ts
```

**å‡ºåŠ›ä¾‹:**
```
ğŸ” ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ç¢ºèªä¸­...

âœ… 1å€‹ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ:

1. ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼1
   ãƒ¦ãƒ¼ã‚¶ãƒ¼ID: test-user-1
   Username: testuser1
   Email: test1@example.com
   Status: ONLINE
   
ğŸ“‹ ãƒ«ãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—:

ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼1:
  âœ“ æ•™å®¤ (classroom)
  âœ“ ã‚®ãƒ£ãƒ©ãƒªãƒ¼ (gallery)
  âœ“ å…¬åœ’ (park)
```

### â• ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒ«ãƒ¼ãƒ ã«è¿½åŠ 

```bash
npx tsx scripts/add-user-to-room.ts <ãƒ¦ãƒ¼ã‚¶ãƒ¼ID> <ãƒ«ãƒ¼ãƒ ID>
```

### ğŸ”„ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒªã‚»ãƒƒãƒˆ

```bash
npx tsx scripts/reset-db.ts
```

### ğŸŒ± ã‚·ãƒ¼ãƒ‰å®Ÿè¡Œã®ã¿

```bash
npx prisma db seed
```

### ğŸš€ å®Œå…¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆãƒªã‚»ãƒƒãƒˆâ†’ã‚·ãƒ¼ãƒ‰â†’ç¢ºèªï¼‰

```bash
npx tsx scripts/setup-dev-env.ts
```

---

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### å•é¡Œ1: `ROOM_FORBIDDEN` ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶:**
```json
{
  "error": {
    "code": "ROOM_FORBIDDEN",
    "message": "ã“ã®ãƒ«ãƒ¼ãƒ ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“",
    "statusCode": 403
  }
}
```

**åŸå› :** ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ«ãƒ¼ãƒ ã®ãƒ¡ãƒ³ãƒãƒ¼ã§ãªã„

**è§£æ±ºæ–¹æ³•:**
```bash
# 1. ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’ç¢ºèª
npx tsx scripts/check-current-user.ts

# 2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒ«ãƒ¼ãƒ ã«è¿½åŠ 
npx tsx scripts/add-user-to-room.ts <ãƒ¦ãƒ¼ã‚¶ãƒ¼ID> classroom
```

---

### å•é¡Œ2: `username` é‡è¤‡ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶:**
```
Unique constraint failed on the fields: (`username`)
```

**è§£æ±ºæ–¹æ³•:**

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³A: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆæ¨å¥¨ï¼‰**
```bash
npx tsx scripts/setup-dev-env.ts
```

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³B: æ‰‹å‹•ã§é‡è¤‡ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å‰Šé™¤**
```bash
# Prisma Studioã‚’é–‹ã
npx prisma studio

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:5555 ã‚’é–‹ãã€
# Userãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰é‡è¤‡ã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å‰Šé™¤
```

---

### å•é¡Œ3: å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶:**
```
Foreign key constraint violated on the constraint: `RoomMember_userId_fkey`
```

**åŸå› :** å­˜åœ¨ã—ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã‚’ä½œã‚ã†ã¨ã—ã¦ã„ã‚‹

**è§£æ±ºæ–¹æ³•:**
```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å®Œå…¨ã«ãƒªã‚»ãƒƒãƒˆ
npx tsx scripts/setup-dev-env.ts
```

---

### å•é¡Œ4: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶:**
```
Can't reach database server
```

**è§£æ±ºæ–¹æ³•:**

1. `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã® `DATABASE_URL` ã‚’ç¢ºèª
2. PostgreSQLã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
3. æ¥ç¶šæƒ…å ±ï¼ˆãƒ›ã‚¹ãƒˆã€ãƒãƒ¼ãƒˆã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼‰ãŒæ­£ã—ã„ã‹ç¢ºèª

---

## ğŸ“Š ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±

### ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼1
- **ID**: `test-user-1`
- **Username**: `testuser1`
- **Email**: `test1@example.com`
- **Password**: ãƒ€ãƒŸãƒ¼ãƒãƒƒã‚·ãƒ¥ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ä¸å¯ï¼‰
- **ãƒ«ãƒ¼ãƒ **: classroom, gallery, park

### ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼2
- **ID**: `test-user-2`
- **Username**: `testuser2`
- **Email**: `test2@example.com`
- **Password**: ãƒ€ãƒŸãƒ¼ãƒãƒƒã‚·ãƒ¥ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ä¸å¯ï¼‰
- **ãƒ«ãƒ¼ãƒ **: classroom, gallery

âš ï¸ **æ³¨æ„**: ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒãƒ€ãƒŸãƒ¼ãªã®ã§ã€å®Ÿéš›ã«ãƒ­ã‚°ã‚¤ãƒ³ã§ãã¾ã›ã‚“ã€‚
å®Ÿéš›ã®ãƒ­ã‚°ã‚¤ãƒ³ã«ã¯ã€ã‚¢ãƒ—ãƒªã®ç™»éŒ²æ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

---

## ğŸ¯ å…¸å‹çš„ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

### æ–°è¦é–‹ç™ºé–‹å§‹æ™‚

```bash
# 1. ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
npx tsx scripts/setup-dev-env.ts

# 2. ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# 3. ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆæ–°è¦ç™»éŒ²ï¼‰

# 4. ãƒ­ã‚°ã‚¤ãƒ³å¾Œã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒ«ãƒ¼ãƒ ã«è¿½åŠ 
npx tsx scripts/check-current-user.ts
npx tsx scripts/add-user-to-room.ts <ãƒ¦ãƒ¼ã‚¶ãƒ¼ID> classroom
```

### æ—¢å­˜ç’°å¢ƒã§ã®ä½œæ¥­

```bash
# ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ã®ã¿
npm run dev
```

### ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ãŸã„æ™‚

```bash
# å®Œå…¨ãƒªã‚»ãƒƒãƒˆ
npx tsx scripts/setup-dev-env.ts

# ã¾ãŸã¯æ‰‹å‹•ã§
npx tsx scripts/reset-db.ts
npx prisma db seed
```

---

## ğŸ“ ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ä¸€è¦§

| ã‚³ãƒ¼ãƒ‰ | æ„å‘³ | å¯¾å‡¦æ³• |
|--------|------|--------|
| `ROOM_FORBIDDEN` | ãƒ«ãƒ¼ãƒ ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒãªã„ | `add-user-to-room.ts`ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è¿½åŠ  |
| `AUTH_UNAUTHORIZED` | èªè¨¼ã•ã‚Œã¦ã„ãªã„ | ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ |
| `VALIDATION_FAILED` | å…¥åŠ›å€¤ãŒä¸æ­£ | ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã‚’ç¢ºèª |
| `RESOURCE_NOT_FOUND` | ãƒªã‚½ãƒ¼ã‚¹ãŒè¦‹ã¤ã‹ã‚‰ãªã„ | IDã‚„URLã‚’ç¢ºèª |

---

## ğŸ”— é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: `src/lib/utils/errors.ts`
- **ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰å®šæ•°**: `src/constants/errors.ts`
- **ãƒãƒ£ãƒƒãƒˆã‚µãƒ¼ãƒ“ã‚¹**: `src/services/chatService.ts`
- **Prismaã‚¹ã‚­ãƒ¼ãƒ**: `prisma/schema.prisma`
- **ã‚·ãƒ¼ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**: `prisma/seed.ts`

---

## ğŸ’¡ Tips

### Prisma Studioã§ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª

```bash
npx prisma studio
```

ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:5555 ã‚’é–‹ãã¨ã€GUIã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ç¢ºèªãƒ»ç·¨é›†ã§ãã¾ã™ã€‚

### ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œæˆ

```bash
npx prisma migrate dev --name <ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å>
```

### Prisma Clientã®å†ç”Ÿæˆ

```bash
npx prisma generate
```

---

## ğŸ“š å‚è€ƒãƒªãƒ³ã‚¯

- [Prisma Documentation](https://www.prisma.io/docs)
- [Next.js Documentation](https://nextjs.org/docs)
- [Socket.io Documentation](https://socket.io/docs)

---

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0  
**æœ€çµ‚æ›´æ–°**: 2025-10-26  
**ä½œæˆè€…**: Schoolverse Team
